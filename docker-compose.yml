services:
    RALM:
      image: hyukkyukang/ralm:py3.13-cuda-12.8.1-cudnn-devel-ubuntu24.04
      container_name: RALM
  
      shm_size: 24gb
      ulimits:
        memlock: -1
      stdin_open: true
      tty: true
      user: user
      network_mode: "host"
  
      environment:
        - TZ=Asia/Seoul
        - UID=${UID}
        - GID=${GID}
  
      volumes:
        - /etc/timezone:/etc/timezone:ro
        - ./:/home/user/RALM
        - /mnt:/mnt
      working_dir: /home/user/RALM
  
      command: |
        bash -c '
          set -e
          echo "export PATH=/home/user/.local/bin:$PATH" >> /home/user/.bashrc
          echo "user" | sudo -S groupmod -o -g ${GID} user
          echo "user" | sudo -S usermod  -o -u ${UID} -g ${GID} user && echo "user ALL=(ALL) NOPASSWD:ALL" > /etc/sudoers.d/user
          tail -f /dev/null
        '
  
  
      deploy:
        resources:
          reservations:
            devices:
              - capabilities: [gpu]
  
